

<link rel="stylesheet" href="{{ url_for('static', filename='post.css') }}">

<div class="post-item" data-post-id="{{ post_data.id }}" id="data-post-id-{{post_data.id}}">
    <div class="post-header">
        <div class="post-author">
            <div class="author-avatar">ğŸ‘¤</div>
            <div class="author-info">
                <span class="author-name">{{ post_data.owner_name }}</span>
                <span class="post-time">{{ post_data.created_at.strftime('%B %d, %Y') }}</span>
            </div>
        </div>
        {% if post_data.owner_name == username %}
        <div class="post-actions">
            <button class="btn-delete" onclick="deletePost({{ post_data.id }})" title="Delete Post">ğŸ—‘ï¸</button>
        </div>
        {% endif %}
    </div>

    <div class="post-content">
        <img src="{{ url_for('static', filename=post_data.image_path) }}" alt="Post image" class="post-image">
    </div>


    <div class="post-footer">
        <div class="post-stats">

            <div class="post-likes-container">
                <button
                    id="like-button-{{post_data.id}}"
                    class="post-likes"
                    hx-post="/api/like_post/{{ post_data.id }}"
                    hx-target="#like-count-{{ post_data.id}}"
                    hx-swap="innerHTML"
                    >{% set user_liked = username in post_data.likes | map(attribute='username') | list %}
                    {%if user_liked%}
                    ğŸ©·
                    {%else%}
                    ğŸ©¶
                    {%endif%}
                    </button>
                    <span
                        id="like-count-{{post_data.id}}"
                        class="post-likes"
                    >{{post_data.likes | length}}</span>
                </div>

            <button
                class="post-comments-toggle post-comments"
                id="comment-toggle-{{ post_data.id }}"
                hx-get="/api/comment_count/{{ post_data.id }}"
                hx-trigger="load"
                hx-swap="innerHTML"
                onclick="toggleComments({{ post_data.id }})">
                ğŸ’¬ 0
            </button>
        </div>
    </div>

    <div class="post-comment-section-container" id="comment-section-{{ post_data.id }}" style="display: none;">
        <!-- Main comment form -->
        <form
            id="comment-section-form-{{ post_data.id }}"
            class="post-comment-section-main-form"
            hx-post="/api/comment/{{ post_data.id }}"
            hx-target="#comments-list-{{ post_data.id }}"
            hx-swap="innerHTML">
            <input
                type="text"
                name="comment"
                placeholder="Write a comment..."
                required>
            <button type="submit">Comment</button>
        </form>

        <!-- Comments list container -->
        <div
            id="comments-container-{{ post_data.id }}"
            hx-get="/api/comments/{{ post_data.id }}"
            hx-trigger="load"
            hx-swap="innerHTML">
            <div class="comments-list" id="comments-list-{{ post_data.id }}">
                <div class="loading-comments">No comments.</div>
            </div>
        </div>
    </div>
</div>
