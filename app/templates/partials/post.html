<link rel="stylesheet" href="{{ url_for('static', filename='post.css') }}">

<div class="bg-white/95 rounded-2xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-2xl hover:scale-[1.01] transition-all duration-300 animate-fade-in post-item"
     data-post-id="{{ post_data.id }}"
     id="data-post-id-{{post_data.id}}">

    <!-- Post Header -->
    <div class="flex justify-between items-center px-6 py-4 border-b border-gray-100">
        <div class="flex items-center gap-3">
            <!-- Avatar -->
            <div class="w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center text-white text-lg shadow-md">
                👤
            </div>
            <!-- Author Info -->
            <div class="flex flex-col">
                <span class="font-semibold text-gray-800 text-base">{{ post_data.owner_name }}</span>
                <span class="text-xs text-gray-500">{{ post_data.created_at.strftime('%B %d, %Y') }}</span>
            </div>
        </div>
        <!-- Delete Button -->
        {% if post_data.owner_name == username %}
        <button onclick="deletePost({{ post_data.id }})"
                class="p-2 rounded-full hover:bg-red-50 hover:scale-110 hover:animate-wiggle transition-all duration-200 text-lg"
                title="Delete Post">
            🗑️
        </button>
        {% endif %}
    </div>

    <!-- Post Image -->
    <div class="relative overflow-hidden bg-gray-50">
        <img src="{{ url_for('static', filename=post_data.image_path) }}"
             alt="Post image"
             class="w-full h-auto max-h-[500px] object-contain hover:scale-105 transition-transform duration-500">
    </div>

    <!-- Post Footer (Likes & Comments) -->
    <div class="px-6 py-4 bg-white/80">
        <div class="flex gap-6 items-center">
            <!-- Like Button -->
            <div class="flex items-center gap-2">
                <button id="like-button-{{post_data.id}}"
                        class="text-2xl hover:scale-110 active:scale-95 transition-transform duration-200 group"
                        hx-post="/api/like_post/{{ post_data.id }}"
                        hx-target="#like-count-{{ post_data.id}}"
                        hx-swap="innerHTML">
                    {% set user_liked = username in post_data.likes | map(attribute='username') | list %}
                    <span class="{% if user_liked %}animate-heartbeat{% else %}group-hover:animate-heartbeat{% endif %}">
                        {% if user_liked %}🩷{% else %}🩶{% endif %}
                    </span>
                </button>
                <span id="like-count-{{post_data.id}}"
                      class="text-gray-600 font-medium text-sm">
                    {{post_data.likes | length}}
                </span>
            </div>

            <!-- Comment Button -->
            <button class="flex items-center gap-2 px-4 py-2 rounded-full hover:bg-gray-100 transition-all duration-200 group post-comments-toggle post-comments"
                    id="comment-toggle-{{ post_data.id }}"
                    data-post-id="{{ post_data.id }}"
                    hx-get="/api/comment_count/{{ post_data.id }}"
                    hx-trigger="load"
                    hx-swap="innerHTML">
                💬 0
            </button>
        </div>
    </div>

    <!-- Comment Section -->
    <div class="hidden px-6 py-4 bg-gray-50 border-t border-gray-100 post-comment-section-container"
         id="comment-section-{{ post_data.id }}">

        <!-- Main Comment Form -->
        <form id="comment-section-form-{{ post_data.id }}"
              class="flex gap-3 mb-5 post-comment-section-main-form"
              hx-post="/api/comment/{{ post_data.id }}"
              hx-target="#comments-list-{{ post_data.id }}"
              hx-swap="innerHTML">
            <input type="text"
                   name="comment"
                   placeholder="Write a comment..."
                   class="flex-1 px-4 py-3 border-2 border-gray-200 rounded-full text-sm focus:border-primary focus:ring-4 focus:ring-primary/20 outline-none transition-all duration-300"
                   required>
            <button type="submit"
                    class="px-6 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-full font-medium shadow-lg hover:scale-105 hover:shadow-xl active:scale-95 transition-all duration-300">
                Comment
            </button>
        </form>

        <!-- Comments List Container -->
        <div id="comments-container-{{ post_data.id }}"
             hx-get="/api/comments/{{ post_data.id }}"
             hx-trigger="load"
             hx-swap="innerHTML">
            <div class="flex flex-col gap-3" id="comments-list-{{ post_data.id }}">
                <div class="text-center py-8 text-gray-500 text-sm">No comments.</div>
            </div>
        </div>
    </div>
</div>
